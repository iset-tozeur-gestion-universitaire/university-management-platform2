<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Connexion API</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-6 text-gray-800">üîç Test de Connexion Backend</h1>
        
        <div class="bg-white rounded-lg shadow-md p-6 mb-4">
            <h2 class="text-xl font-semibold mb-4">R√©sultats des Tests</h2>
            <div id="results" class="space-y-2"></div>
        </div>

        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4">Donn√©es R√©cup√©r√©es</h2>
            <div id="data" class="space-y-4"></div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:3000';
        const results = document.getElementById('results');
        const dataDiv = document.getElementById('data');

        function addResult(name, success, message, data = null) {
            const div = document.createElement('div');
            div.className = `p-3 rounded ${success ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`;
            div.innerHTML = `
                <strong>${success ? '‚úÖ' : '‚ùå'} ${name}</strong>: ${message}
                ${data ? `<br><small>Donn√©es: ${JSON.stringify(data).substring(0, 100)}...</small>` : ''}
            `;
            results.appendChild(div);
        }

        function displayData(title, data) {
            const div = document.createElement('div');
            div.className = 'border-l-4 border-blue-500 pl-4';
            div.innerHTML = `
                <h3 class="font-semibold text-lg mb-2">${title}</h3>
                <pre class="bg-gray-50 p-3 rounded text-sm overflow-auto">${JSON.stringify(data, null, 2)}</pre>
            `;
            dataDiv.appendChild(div);
        }

        async function testEndpoint(name, url) {
            try {
                const response = await fetch(`${API_URL}${url}`);
                if (response.ok) {
                    const data = await response.json();
                    addResult(name, true, `${data.length || 0} √©l√©ments r√©cup√©r√©s`, data.slice(0, 2));
                    displayData(name, data.slice(0, 3));
                    return data;
                } else {
                    addResult(name, false, `Erreur ${response.status}: ${response.statusText}`);
                    return null;
                }
            } catch (error) {
                addResult(name, false, `Erreur: ${error.message}`);
                return null;
            }
        }

        async function runTests() {
            addResult('Connexion Backend', true, 'D√©but des tests...');
            
            await testEndpoint('D√©partements', '/departement');
            await testEndpoint('√âtudiants', '/etudiants');
            await testEndpoint('Enseignants', '/enseignant');
            await testEndpoint('Classes', '/classe');
            await testEndpoint('Sp√©cialit√©s', '/specialite');
            
            addResult('Tests Termin√©s', true, 'Tous les tests ont √©t√© ex√©cut√©s');
        }

        // Lancer les tests au chargement
        runTests();
    </script>
</body>
</html>
